---
title: 非线性方程求根
date: 2019-11-2
tags:
- 课程笔记
category:
- C++
- C++语法
mathjax: true
---

## 多元函数误差分析

基本概念：绝对误差 $\varepsilon(x)$ 和相对误差 $\varepsilon_r(x) = \frac{\varepsilon(x)}{x*}$

$$z=f(x_0,x_1,...x_n)$$ 

$$\varepsilon(z) \approx \sum_{k=1}^{n}|\frac{\partial f}{\partial x_{k}}| \varepsilon(x_{k})$$

特殊情况：

$$\begin{aligned}
\varepsilon(x_1+x_2) &=\varepsilon(x_1)+\varepsilon(x_2) \\\\
\varepsilon(x_1 \cdot x_2) & \approx|x_1| \varepsilon(x_2)+|x_2| \varepsilon(x_1) \\\\
 \varepsilon(x_1 / x_2) & \approx \frac{|x_1| \varepsilon(x_2)+|x_2| \varepsilon(x_1)}{x_2^2}
\end{aligned}$$

比如 $z=xy$ 误差为 $|x|y'+x'|y|$。

应用：对于除法的情况，避免绝对值小的量当分母。

安利秦九韶算法来计算多项式。  
在不同数据下误差小的算法就叫 `稳定的算法`。

### 例题：稳定的算法

看一个例子：利用递推式计算 $I_n$ 的估计值 $S_n$。 

$$I_n = e^{-1} \int_0^1 x^n*e^x dx \quad (n = 0, 1, ...,20)$$

对积分值可以放缩：由于 $1 \leq e^x \leq e \quad(0<x<1)$，有

$$\frac{e^{-1}}{n+1} \leq e^{-1} \int_0^1 x^n*e^x dx \leq \frac{1}{n+1}$$

* 方法一：利用分部积分求得递推式

$$\begin{cases}
I_0 &= 1-e^{-1} \\\\
I_n &= 1-n I_{n-1},(n=1,2, \cdots)
\end{cases}$$

如果推出递推式用迭代法从小往大，$n>=20$ 的时候误差值就会变得非常大，甚至超出了预估值的范围（$S_{20} = -30.19$）  
理由是初值有误差，每次迭代都会放大误差。那么能不能把放大误差变成缩小误差呢？  

**——把递推式中的 `*n` 换为 `/n`，从后往前推**。

* 方法二：先算 $S_{30}$ 再往前推，最后误差极小，这时候这就是一个稳定的算法。

由 $I_n$ 的估计式，令 $S_n = \frac{1}{31}$。
反解上面的递推式，得 $I_{n-1} = \frac{1}{n}(1-S_n)$。

然后再次跑递推，得到的 $S_1$ 能保证 $10^{-14}$ 的精确度。


## 非线性方程数值方法


前人：n>=5时无显式求根公式
基本思想：迭代法逼近
第一步：对fx=0 的根进行隔离
第二步：利用迭代法计算一定精度的根近似值
从给定的一个出发值x0，产生一个序列x0，x1...

1.二分法，二分夹逼，简单无脑，要求单调
定理2 误差满足<|b-a|/(2^(n+1))

2.牛顿迭代法，迭代快（Matlab调用）
引理：...证明略，结论是导函数小于1，增长速度小于线性
对于不同的phi，初值需要先验

定义r阶收敛：对于数列xi，如果limxi^r 存在，则这个数列r阶收敛，用来刻画快慢
r=1 线性收敛  r=2 平方收敛...
线性收敛：每次迭代误差放大k倍
超收敛(r>1) 每次迭代误差是上一次误差的r次方的k倍数，在这个含义下，如果第一次误差1%，r=2，那么迭代一次后误差为0.01%*k


## 牛顿迭代法（正确性根据引理，从略）


基本思想：泰勒公式将非线性函数线性化
设函数fx在有根空间[a,b]二次连续可微，泰勒后只取线性部分。
**用切线方程的根近似原fx的根，然后多次牛顿迭代近似**

牛顿迭代法的几何意义
上一次得到根x1，再在x1的地方做泰勒近似到x2... 用上一个根迭代下一个根，nb
所以单变量牛顿迭代法也被称为切线法

一个例题，实际使用估计还得工具箱？
有缺陷的牛顿迭代法

```m
f=inline('x*exp(x)-1');
f1=inline('(x+1)*exp(x)');
x0=0.5;er=1;k=0;
while er>0.00001
    x=x0-f(x0)/f1(x0);
    er=abs(x-x0)
    x0=x; k=k+1
end
```

缺陷：
1.被0除错误，根使得原函数和导函数都为0的情况，称为二重根
可以考虑加一个eps？
2.死循环：对于特殊函数无法使用arctanx
多次迭代无进展的话跳出，换个算法

另一个例题
看看两个解之间的距离是不是逐渐变小且函数值是不是逐渐变小来判断是否收敛、是否适用于牛顿迭代法


### 牛顿迭代法的简单改进：弦截法


现在不知道具体函数表达式，只有一些离散值（目前知道是用来解决这样的一些问题）
听不懂，给出程

## 范数简介


向量的范数：
（绝对值的定义）
来一个公理化的定义：正定性、齐次性、三角不等式
范数是对长度的推广，三角不等式根据柯西不等式证明得到

又把上节课讲的范数再讲了一遍1、2、无穷范数
一般向量而言，1范数>无穷范数，1范数<n*无穷范数

相容性、等价性
**性质：向量空间的任何范数均等价**
1-范数、无穷范数随便选，算起来都简单