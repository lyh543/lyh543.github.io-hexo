---
title: Verilog HDL 速成手册
date: 2019-12-02 21:37:29
tags:
- 课程笔记
mathjax: true
---

## 概述

（以下抄 PPT）

> Verilog HDL（以下简称 Verilog）是一种硬件描述语言，用于从算法级、门级到开关级的多种抽象设计层次的数字系统建模。 

Verilog硬件描述语言的主要功能包括：

1. 基本逻辑门，例如 `and`、`or` 和 `nand` 等都内在语言中。
2. 用户定义原语（UDP）创建的灵活性。用户定义的原语既可以是组合逻辑原语，也可以是时序逻辑原语。
3. 开关级基本结构模型，例如 `pmos` 和 `nmos` 等也被内置在语言中。
4. 提供显式语言结构指定设计中的端口到端口的时延及路径时延和设计的时序检查。
5. 可采用三种不同方式或混合方式对设计建模。这些方式包括：
* **行为描述方式**——使用过程化结构建模；
* **数据流方式**——使用连续赋值语句方式建模；
* **结构化方式**——使用门和模块实例语句描述建模。
6. Verilog HDL 中有两类数据类型：**网络数据类型和寄存器数据类型**。网络类型表示构件间的物理连线，而寄存器类型表示抽象的数据存储元件。
7. 能够描述层次设计，可使用模块实例结构描述任何层次。
8. 设计的规模可以是任意的，语言不对设计的规模（大小）施加任何限制。

等我学完这一章以后再来看看哪些不重要，可以删。

## 程序基础

### Verilog 由模块构成

> 一个复杂电路系统的完整 Verilog HDL 模型是由若干个 **Verilog HDL 模块**构成的，每一个模块又可以由若干个子模块构成。

（划重点，模块 `module` 思想）

模块是什么？

> 用 Verilog HDL 描述的电路设计就是该电路的 Verilog HDL 模型，也称为模块，是 Verilog 的基本描述单位。  
> 一般来说一个模块可以是**一个元件**或者是**一个更低层设计模块的集合**。  
> 模块是**并行运行**的，通常需要一个高层模块通过调用其他模块的实例来定义一个封闭的系统，包括测试数据和硬件描述。

老师连 PPT 都不分行的吗，还得我手动分行。。。

### 代码结构

Verilog 程序结构：

```v
// 模块声明
module 模块名（端口列表）

    // 端口定义
    input 输入端口
    output 输出端口
    inout 输入/输出端口

    // 数据类型说明
    wire
    reg
    parameter

    // 逻辑功能定义
    assign
    always
    function
    task
    // ....

endmodule
```

以上各部分解释：

* <模块名> 是模块唯一的标识符；
* <端口列表> 是由模块各个**输入**、输出和双向端口组成的一张端口列表，这些端口用来与其他模块进行通信；
* 数据类型说明部分：用来指定模块内用到的数据对象为**寄存器型**、**存储器型**还是**连线**型；
* 逻辑功能定义部分：通过使用**逻辑功能语句**来实现具体的逻辑功能。

### 语言基础

* 每个 Verilog HDL 程序源文件都以 `.v` 作为文件扩展名。
* Verilog HDL区分大小写。
* Verilog HDL程序的书写与C语言类似
  * 一行可以写多条语句
  * 也可以一条语句分成多行书写
  * **每条语句以分号结束**（endmodule语句后不加分号）
  * 新行、制表符和空格没有特殊意义

#### 数值和数据类型

数值有四种：

值的级别|硬件电路中的条件
-|-
0|逻辑 0，条件为假
1|逻辑 1，条件为真
x|逻辑值不确定
z|高阻，浮动状态

数据类型上，分为 `net`（线网型）和 `reg`（寄存器型）。

`reg` 类型，是使用寄存器实现，用于存储数据，类似于电脑 CPU 的寄存器、内存等等。

其中 `net` 分为 `wire`、`wand`、`wor` 等等，由于 `wire` 类型的线网声明最常用，所以 `net` 和 `wire` 概念经常互换使用。

而 `wire` 是什么呢？翻译成 `线网` 非常抽象，其实是个很常见的东西：

想象一个“与门”，它有两个输入 `A` 和 `B`，输出 `F`。在这里 `A`、`B`、`F` 都是电线，他们也就是所谓的 `线网` 或 `wire`。

合理猜测，对于线网型和寄存器型，将是两种风格的编程；前者是描述各种“门”，后者是类似于 C 语言的赋值、赋值、再赋值的编程。

确实如此。[概述](#概述)的第 5 点提到，

> **数据流方式**——使用连续赋值语句方式建模；  
> **结构化方式**——使用门和模块实例语句描述建模。

`数据流`即是使用赋值和寄存器的 C 语言风格，  
`结构化`即是描述各个门，使用线网类型的结构化风格。  
当然也可以混合编程。

等我学完这一章以后再来看看是不是这样。

### 程序结构

#### 模块声明

```v
module <module_name>(port_name1,…,port_namen);

// ...
// ...

endmodule;
```

* `module_name` 为模块名（类似于 C 语言的函数名）。
* `port_name` 为端口名（类似于函数的输入输出），

#### 端口定义

```v
input <input_port_name>, ...<other_inputs>...;   //输入
output <output_port_name>,...<other_outputs>...; //输出
inout <inout_port_name>,...<other_inouts>...;    //双向端口
```

双向端口类似于输入以后被修改了，然后输出？

注意：

1. 在声明输入/输出时，要声明其数据类型是 `net` （网络）型还是 `reg` （寄存器）型；默认为 `wire` 类型。
2. 无论是在网络说明还是寄存器说明中，网络或寄存器必须与端口说明中指定的宽度相同。
3. 输入和双向端口不能声明为寄存器型。

也可以使用 C 语言风格的端口声明。

示例：

```v
module addr(cout,sum,ina,inb,cin);
    input cin;
    input[7:0] ina,inb;
    output[7:0] sum;
    output cout;
    //...
endmodule
```

```v
module fulladd4(output reg [3:0] sum, output reg c_out,
    input [3:0] a,b,input c_in);
     
    //...

endmodule 
```

？？？这里有引号？

Verilog语言要素
Verilog常量
Verilog语言数据类型
Verilog语言表达式
Verilog的行为级描述语句
Verilog的门级描述语句
Verilog系统任务和函数
Verilog用户定义任务和函数
Verilog语言模块描述方式