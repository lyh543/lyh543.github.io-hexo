---
title: 欧拉函数（坑）
tags:
- 数论
- 坑
category:
- C++
- ACM
mathjax: true
---

## 定义

欧拉函数$\varphi(n)$：对于正整数$n$，在小于等于$n$的正整数之中，和$n$互质的数的个数。

如在 1 到 8 之中，与 8 形成互质关系的是1、3、5、7，所以$\varphi(n)=4$。

## $\varphi(n)$ 的计算

### 1. 如果 $n=1$

$$\varphi(n)=1$$

### 2. 如果 $n$ 是质数

$$\varphi(n)=n-1$$

### 3. 如果 $n=p^k$

$$\varphi(n)=p^k-p^{k-1}$$

因为 $p^k$ 有 $p^{k-1}$ 个因数

又可以写成

$$\varphi(p^k)=p^k\cdot(1-\frac{1}{p})$$

### 4. 如果 $n=p1\cdot p2$

$$\varphi(n)=\varphi(p_1p_2)=\varphi(p_1)\varphi(p_2)$$

> 如果 $a$ 与 $p_1$ 互质 $(a<p_1)$ ，$b$与 $p_2$ 互质 $(b<p_2)$ ，则 $a\cdot p_2+b\cdot p_1$ 肯定与 $p_1p_2$ 互质。
> 由于 $a$ 一共有 $\varphi(p_1)$ 种取值可能， $b$ 一共有 $\varphi(p_2)$ 个取值可能，所以 $\varphi(p_1p_2)$ 就等于$\varphi(p_1)\varphi(p_2)$.

感觉有点不严谨额，不过就这么记吧。

### 5. 对于剩余情况

$$
\begin{split}
\varphi(n) & = \varphi(p_1^{k_1})\varphi(p_2^{k_2})\cdots\varphi(p_r^{k_r}) \\\\
& = p_1^{k_1} p_2^{k_2} \cdots p_r^{k_r} (1-\frac{1}{p_1})  (1-\frac{1}{p_2}) \cdots  (1-\frac{1}{p_r}) \\\\
& = n (1-\frac{1}{p_1})  (1-\frac{1}{p_2}) \cdots  (1-\frac{1}{p_r})
\end{split}
$$

好我学会了~~实际上并没有~~

### 欧拉定理

若 a 与 n 互质，则：

$$a^{\varphi(n)}\equiv 1(mod\quad n)$$

### 神奇的性质

$$\sum_{(d|n)}\varphi(d)=n$$
