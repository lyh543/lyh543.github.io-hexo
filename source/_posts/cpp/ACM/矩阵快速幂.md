---
title: 矩阵快速幂
date: 2019-7-26
tags:
- 数论
category:
- C++
- ACM
mathjax: true
---

就是数字快速幂外加定义一个矩阵乘法（复杂度 $O(k^3*log(n))$，但是 $k$ 是常数）。可以用于求加法的递推式（如斐波那契数列）。

其余就没什么好说了的吧。学好线代。

```c++
const int mod = 1e9 + 7, Mn = 5;

struct matrix
{
	ll v[Mn][Mn];
	ll * operator[](int i){return v[i];}
};

matrix operator * (const matrix &a,const matrix &b)
{
	matrix c;
	memset(c.v, 0, sizeof(c.v));
	for (int i = 0; i < Mn; i++)
		for (int j = 0; j < Mn; j++)
			for (int k = 0; k < Mn; k++)
				c[i][j] += a.v[i][k] * b.v[k][j] % mod, c[i][j] %= mod;
	return c;
}

matrix quickpow(matrix base, ll n)
{
	matrix ans;
	memset(ans.v, 0, sizeof(ans.v));
	for (int i = 0; i < Mn; i++)
		ans.v[i][i] = 1;
	while (n) {
		if (n % 2 == 1) ans = base * ans;
		n /= 2;
		base = base * base;
	}
	return ans;
}

matrix baseM =
{
	{{1,1,1,1,0},
	{1,0,0,0,0},
	{0,1,0,0,0},
	{0,0,0,1,1},
	{0,0,0,0,1}}
};
```
