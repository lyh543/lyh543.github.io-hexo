<% if (theme.gitalk){ %>
<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
//      var id = location.pathname
//      if (location.pathname.length > 50) {
//        id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
//      }
        const gitalk = new Gitalk({
          clientID: '<%- theme.gitalk.client_id %>',
          clientSecret: '<%- theme.gitalk.client_secret %>',
          repo: '<%- theme.gitalk.repo %>',
          owner: '<%- theme.gitalk.owner %>',
          admin: ['<%- theme.gitalk.owner %>'],
          id: md5(location.pathname),      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>
<% } %>
